<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link rel="stylesheet" href="https://www.w3schools.com/w3css/4/w3.css">
<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Lato:400,900">
<style>
  body {font-family: "Lato", sans-serif}
  .drawboard {background-image: url(data:image/svg+xml;charset=utf-8,%3C%3Fxml%20version%3D%221.0%22%20encoding%3D%22UTF-8%22%20standalone%3D%22no%22%3F%3E%3Csvg%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%20width%3D%2264%22%20height%3D%2264%22%20viewBox%3D%220%200%2064%2064%22%20version%3D%221.1%22%3E%3Cg%20style%3D%22fill%3Anone%3Bstroke%3A%23000%3Bstroke-width%3A2%3Bstroke-linecap%3Around%3Bstroke-linejoin%3Around%3Bstroke-miterlimit%3A4%3Bstroke-dasharray%3A600%22%3E%3Cpath%20style%3D%22stroke-dashoffset%3A600%3Bstroke-width%3A2.5%22%20d%3D%22m20%2C23.5c2%2C-4%204%2C-7%205.5%2C-8%202%2C0%204%2C1%206%2C4%22%2F%3E%3Cpath%20style%3D%22stroke-dashoffset%3A620%3Bstroke-width%3A2.5%22%20d%3D%22m31.5%2C22.5c3%2C-6%205%2C-6%206%2C-6%201%2C0%203%2C3%207%2C10%22%2F%3E%3Cpath%20style%3D%22stroke-dashoffset%3A660%3Bstroke-width%3A3.5%22%20d%3D%22m26.5%2C26.5v0.5%22%2F%3E%3Cpath%20style%3D%22stroke-dashoffset%3A670%3Bstroke-width%3A3.5%22%20d%3D%22m36.5%2C26.5v0.5%22%2F%3E%3Cpath%20style%3D%22stroke-dashoffset%3A680%22%20d%3D%22m29.5%2C34.5h5L32%2C38.5%2029.5%2C34.5%22%2F%3E%3Cpath%20style%3D%22stroke-dashoffset%3A710%22%20d%3D%22M26.5%2C36.5C20%2C35%2011%2C34%203%2C32%22%2F%3E%3Cpath%20style%3D%22stroke-dashoffset%3A735%22%20d%3D%22M26%2C39.5C19%2C39%2013%2C39%206%2C40%22%2F%3E%3Cpath%20style%3D%22stroke-dashoffset%3A760%22%20d%3D%22M26%2C42C19%2C42%2014%2C44%208%2C46%22%2F%3E%3Cpath%20style%3D%22stroke-dashoffset%3A785%22%20d%3D%22m38%2C37c8%2C-1%2015%2C-2%2024%2C-2%22%2F%3E%3Cpath%20style%3D%22stroke-dashoffset%3A810%22%20d%3D%22m39%2C39.5c8%2C0%2014%2C0%2019%2C2%22%2F%3E%3Cpath%20style%3D%22stroke-dashoffset%3A835%22%20d%3D%22m38%2C42c8%2C1%2014%2C3%2021%2C6%22%2F%3E%3Cpath%20style%3D%22stroke-dashoffset%3A870%22%20d%3D%22m28%2C46c3%2C2%205%2C3%208%2C0%22%2F%3E%3Cpath%20style%3D%22stroke-dashoffset%3A920%3Bstroke-width%3A10%3Bstroke%3A%23fff%22%20d%3D%22M17%2C18%2053%2C21%206%2C31%2059%2C37%207%2C42%2058%2C47%22%2F%3E%3Canimate%20attributeType%3D%22CSS%22%20attributeName%3D%22stroke-dasharray%22%20from%3D%22600%22%20to%3D%221200%22%20dur%3D%2215s%22%20repeatCount%3D%22indefinite%22%2F%3E%3C%2Fg%3E%3Cg%20style%3D%22fill%3Anone%3Bstroke%3A%23ccc%3Bstroke-width%3A15%3Bstroke-linecap%3Around%3Bstroke-linejoin%3Around%3Bstroke-dasharray%3A1%20600%201%20599%3Bstroke-dashoffset%3A920%22%3E%3Cpath%20d%3D%22M17%2C18%2053%2C21%206%2C31%2059%2C37%207%2C42%2058%2C47%22%2F%3E%3Canimate%20attributeType%3D%22CSS%22%20attributeName%3D%22stroke-dashoffset%22%20from%3D%22920%22%20to%3D%22320%22%20dur%3D%2215s%22%20repeatCount%3D%22indefinite%22%2F%3E%3C%2Fg%3E%3C%2Fsvg%3E)}
</style>
</head>
<body>
<div class="w3-top">
  <div class="w3-bar w3-black w3-card">
    <a href="#twim" class="w3-bar-item w3-button w3-padding-large">2im</a>
    <a href="#demo" class="w3-bar-item w3-button w3-padding-large">Demo</a>
  </div>
</div>

<div class="w3-content" style="max-width:2000px;margin-top:46px">
  <div class="w3-light-gray" id="twim"><div class="w3-container w3-content w3-center" style="max-width:800px">
    <h2 class="w3-wide">2im</h2>
    <p class="w3-opacity"><i>Everything should be made as simple as possible, but no simpler.</i></p>
    <p class="w3-justify"><b>2im</b> (or <b>twim</b>) is a new image compression format.</p>
    <p class="w3-justify">
      JPEG, GIF and PNG are the most popular image formats in the web.
      PNG is used mainly used for lossless encoding, GIF supports animated images,
      and JPEG is perfect for lossy photos encoding...
    </p>
    <p class="w3-justify">
      <b>But</b> modern responsive web has one more use-case: embeddable image previews.
      2im has been designed exactly for that: encoding 64 x 64 image preview into <b>2</b>00 bytes...
      Or 192 x 192 picture into <b>tw</b>itter message...
    </p>
    <p class="w3-justify">
      Unlike most other codecs, the main parameter for codec is not some abstract quality,
      but output size (in bytes). Encoder will try to find the best representation that fits the bit budget.
    </p>
    <img class="w3-card-4" src="cat.gif">
    <p class="w3-justify">
      Moreover, simple image format allows fast and small JS decoder (just 1881 bytes / 1089 when compressed with Brotli).
    </p>
    <p class="w3-justify">
      See also: <a href="twim-vs-sqip.html">comparison with SQIP primitive art</a>.
    </p>
  </div></div>

  <div id="demo"><div class="w3-container w3-content w3-center" style="max-width:800px">
    <h2 class="w3-wide">Demo</h2>
    <p class="w3-opacity"><i>一畫勝千言</i></p>
    <input class="w3-input w3-border w3-round" type="text" id="encoded" placeholder="Insert base64-encoded 2im image here">
    <div class="w3-xlarge">⇩</div>
    <canvas class="w3-card-4 w3-white w3-margin-bottom drawboard" id="canvas" width="64" height="64"></canvas>
    <div id="demo-placeholder" class="w3-hide"></div>
  </div></div>

  <div class="w3-margin-bottom"></div>
</div>

<script type="text/javascript" src="twim.js"></script>
<script type="text/javascript">
let input = document.getElementById('encoded');
function onInput() {
  let ctx = document.getElementById('canvas').getContext('2d');
  ctx.clearRect(0, 0, 64, 64);
  let encoded = new Uint8Array(Array.from(atob(input.value)).map(s => s.codePointAt(0)));
  ctx.putImageData(window.decode2im(encoded), 0, 0);
}
function onCopyClick(id) {
  let src = document.getElementById(id);
  src.removeAttribute('disabled');
  src.select();
  document.execCommand("copy");
  src.setAttribute('disabled', 1);
  input.value = src.value;
  onInput();
}
document.addEventListener('DOMContentLoaded', () => {
input.addEventListener('input', onInput);
document.getElementById('demo-placeholder').outerHTML = [
  ['The Swiss flag – a plus for the country (25 bytes):', 'Dqf4Yo9Zarz///8AA6HEgsU4HRLZzUUlRA=='],
  ['No effort to learn and improve over time (128 bytes):', 'DifgrJxhf78vQWQ93d1f8zXvJYYV6UuX1OUhz0mq0C4BRmeEd8P8g84IbX0DW/3nkDuRqCiF+ooO259rra4WdiQM1uX16R8EUgbupgkEteS+w/f+thOzSX+SI+h3Fun56h91J3iShnaYtrq6hwLgiIKh8A5q2GWBorsJ4DOGHgM='],
  ['That cat\'s something I can\'t explain (256 bytes):', 'Dhf4bNtyTrkwN+IwOQ3lZUtrNwbD7YuwQFHeyXNYiru3nmuOS5sj+aaaP2C1PTU/jJmuVYMTgd8d2z4m2GfTEvKWjmFZVzHYxCu4BwZJC4J+CHbzliwbddUhfYoMNDBkwjrZsxDtOdm/lwsOwdtYkjY2Xy2HeeYfxNXFdkppquDgDxkhNJsHPdYsOgzijY1UQ/owjHwXd/9310lai54qjUy7CXi92k022wjsGZxfilGgageYdAgKQu50ps7TxMDXJi1FtG1o3NY56mN+NNLVkwcV/cur8pDJIzeENO4mVGrDfGEuL4LaXHm+pqwXx5Vjg4s/gR8zrV2YKsod5LcETQ=='],
  ['In time, all great masterpieces turn into shameless creatures who laugh at their creators (383 bytes):', 'Dsfor7ypbCPgug0AWEYQiNpdLRAj0jn6lc4kifqwkgSbmkamW6FGLZtZUZg7S0ruxoo4xSMkFys9sX6x9dka5RvoPHB845hz3ol2U2/zyIXb9KPiDZ3As4vcABrTRsaNqB6Dl72Epodexq4Y2KiideDX+c/GALYs/kWC+FEiJW1q5osjpP0epwxV36ztl23aeZVHcEC3DF2drmIHVQgrY65HJowg5lHiJFO1WKnIg4ctCvdS5bRlg/w2MyoMfIRute1JaiWchr94VdF6IhY8Ku88Ade/Ndq0btk34zPZGTyXtfwudpw3J2OG877Hv5gu0cL56l2xSwAZpom32+IEQzCR9hfyRmg+P5PqQxaWUkOQ1X7V4KMiwT99qsomRZnqB7CfSprEBN5GSjO73AuGsIzCakyoPz1EH+aJCIZSjm/PoWFby5txqiVtelWmkz0HmraDBLaZTARxw2FAIy8KVOAwHELCOxxmpaH/Z6L4QsjKm2mOWBt332tDW4Aahes='],
  ['For millions of years, mankind lived just like the animals. Then something happened which unleashed the power of our imagination (512 bytes):', 'DsfYnXomOLjj42N6evrFxUVRUVETE5OpqamAgIChoaHk5OTi4uKenp6GhobI+o8HUbS33Mb/90RpTaGMnyi8d3oEO89lXd2w2+rdGjLyYwI6IJlf7zgAX47+l8ETRQwnN3Hz4VXs7PX3yi40s/qO95r8Aia0EO1nqQ+WfWD+nrF6oYOwO/a66UBTmgAVyZEl+r3J84wJ/2MR18MgdGHPwBAnMDbsBATxYbHhcnPSjFkZMcqwVw3FiH2UJm0Ozh4wpDEvSZCxXQ8Y4ASSI1xrxPy3G2WaB/Jr/Bw05vbQLIqkm7VhKdfX8TOIIZnmjdkHWEWkLlco5506c3iip1WsVygk9hPlc3yp7ugc8cuMG6yBhvtJeXtCgyyG/KTIsq83LClM6WLC2MSUIZW56vYDM6O4tF5Fj6AqblM0gO7TyJ6iQnRv9kSkG2iIyt3plylYJYf1/zu9IXNfq0uV6IzCMJ2LwoVNa28/KRniDZLlwiHHYpNN17IQADbO1gx9TFMJI45b9JubYUON4mvvEcQVafW8FBRvA8iVg9Yq5O76YNgHuEne6wRDHYdhxgev2eCqt8OcUamSPZw5h8hAgHKFyoGopUEkfruumnaQU9/M0AVw7cTzaoDVYu9xolhOYqmPGrIT5ot5U1mRMsA0qj6nm7tis2T16SkAqtcO6QrTJwE=']
].map((v, i) => '<p class="w3-justify">' + v[0] + '</p><div class="w3-row w3-border w3-round"><button class="w3-button w3-col w3-right w3-border-bottom w3-border-left w3-light-gray" style="width: 33px;height: 39px; padding: 8px" onclick="onCopyClick(\'demo' + i + '\')"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="18" viewBox="0 0 16 18" version="1.1" style="vertical-align: middle"><path style="fill:none;stroke:#000" d="M2.5,7V2.5h9v12h-9V11M4,0.5h9.5V13"/><path d="M0,8H5V6L8,9 5,12V10H0Z"/></svg></button><div class="w3-rest"><input class="w3-input" disabled type="text" id="demo' + i + '" value="' + v[1] + '"/></div></div>').join('');
});
</script>
</body>
</html>
